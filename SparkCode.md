# How to run Spark Code
For the spark implementation, we have a separate java class for each function i.e
- Index Create
- SearchWord
- SearchPhrase
- Positive Value
  
These classes can be found in /SparkCode/demo/src/main/java/com/example
Built as a maven project

## Packaging the jar file
In order to run the spark jobs, we first need to pacakge the classes in a jar file using the command 
**mvn package** in the /demo directory. This creates a jar file demo-1.0.0.jar in the target.

## Submitting a spark job
Using the jar created in the previous step we can submit spark jobs to the cluster using the spark-submit script provided as part of the spark distribution by apache.

The general syntax is 
/usr/local/spark/bin/spark-submit --class "com.example.**ClassName**" --master local[4] target/demo-1.0.0.jar **args**

- **ClassName**  is the class whose main function will be used to create a spark job
- **args** - these are the string args[] passed to the main function of your code. 
  **Note - Here the arguments start with arg[0] itself. That is unlike normal programs the first argument to the main function is not the name of the file**

## Creating a Index
### Command
/usr/local/spark/bin/spark-submit --class "com.example.IndexCreate" --master local[4] target/demo-1.0.0.jar

### Directory Structure and Home variable
However for it to run properly you may need to change **HOME** variable in the java class to point to the actual directory where the database files are stored. 
The directory structure assumed by this script is that a **/input** directory is present at the **HOME** path which contains all the files of the database. These files are preprocessed and a linenumber is present in of these lines. A input directory is present in the /SparkCode directory as an example.

### Output Expected
If everything runs properly this creates another directory at the **HOME** path as /index
This /index directory has the index built by the spark job.
You can see the /index in the SparkCode directory as an example

## Searching a Word

### Command
/usr/local/spark/bin/spark-submit --class "com.example.SearchWord" --master local[4] target/demo-1.0.0.jar **WordToBeSearched**

- **WordToBeSearched** - this is the word for which we need to find the positions in the database

### Home variable and Directory Structure
This job assumes that at the **HOME**  path there is a directory as /index which has the index files. These are generated by the previous job.

### Output Expectation
If everything runs properly this creates another directory at the **HOME** path as /searchWord
This /searchWord directory has the files built by the spark job. These files contain the filename, lineNumber, position and the text of the line where **SearchWord** is present.

/searchWord in the SparkCode directory is the output for the job that searched "the" word in all the files. 

## Searching a phrase

### Command
/usr/local/spark/bin/spark-submit --class "com.example.SearchPhrase" --master local[4] target/demo-1.0.0.jar **PhraseToBeSearched** **PhraseClause**

- **PhraseToBeSearched** - this is a space separated string of the words for which we need to find the positions in the database
- **PhraseClause** - "and" or "or" depending on the requirements

### Home variable and Directory Structure
This job assumes that at the **HOME**  path there is a directory as /index which has the index files. These are generated by the index create job.

### Output Expectation
If everything runs properly this creates another directory at the **HOME** path as /searchPhrase
This /searchPhrase directory has the files built by the spark job. These files contain the filename, lineNumber, positions and the text of the line where **SearchPhrase** is present.

/searchPhrase in the SparkCode is the output for the job that searched phrase **"the hair" or** in all the files.

## Positive Value

### Command
/usr/local/spark/bin/spark-submit --class "com.example.PositiveValue" --master local[4] target/demo-1.0.0.jar

### Home variable and Directory Structure
This job assumes that at the **HOME**  path there is a directory as /index which has the index files. These are generated by the index create job.
This job also assumes that there is a file "positive words.csv" at the **HOME** directory as provided in the asignment.

### Output Expectation 
If everything runs properly this creates another directory at the **HOME** path as /positiveValue
This /positiveValue directory has the files built by the spark job. These files contain the filename and their positive Value based on the number of positive words conatined in that file.

/positiveValue in the SparkCode is the output for the job