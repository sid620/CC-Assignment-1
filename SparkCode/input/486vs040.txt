     1	
     2	
     3	
     4	               CISC  :  The Intel 80486 vs. The Motorola MC68040
     5	              ---------------------------------------------------
     6	
     7	               Source : Advanced Microprocessors by Daniel Tabak
     8	
     9	               Scribe : X-> Mike <-X  -  July '92
    10	
    11	              ---------------------------------------------------
    12	
    13	
    14	System Comparison
    15	
    16	        Most of the space in this text is dedicated to the most recent
    17	advanced CISC microprocessors, the top current products within their families;
    18	the Intel 80486 and the Motorola MC68040.   They both belong to the latest
    19	1.2 million transistors per chip generation.   It therefore makes sense
    20	to compare the two.   It would be unfair to compare the NS32532 with them,
    21	since the NS32532 belongs to an earlier generation and it is not in the same
    22	class as the 80486 and MC68040.
    23	 
    24	        A selection of points of comparison between the 80486 and the MC68040
    25	is listed in Table 1.1.   Looking carefully at the table, one can perceive
    26	only a single line indentically marked in both columns: both chips have an
    27	on-chip FPU, conforming to the IEEE 754-1985 standard.   All other data are
    28	different, although quite close in some instances.   The points of difference
    29	between the 80486 and the MC68040 will be discussed next in some detail.
    30	 
    31	 
    32	         Table 1.1   Comparison of Intel 80486 and Motorola MC68040
    33	-------------------------------------------------------------------------------
    34	       Feature                         Intel 80486       Motorola MC68040
    35	-------------------------------------------------------------------------------
    36	FPU on Chip                            Yes (IEEE)        Yes (IEEE)
    37	CPU General-Purpose 32-bit Registers   8                 16; 8 Data/8 Address
    38	FPU 80-bit Registers                   8 (stack)         8
    39	MMU on Chip                            Yes               Yes; Dual: Data, Code
    40	Cache on Chip                          8k Mixed          4k Data + 4k Code
    41	Segmentation                           Yes               No
    42	Paging                                 Yes; 4k/page      Yes; 4k or 8k/page
    43	TLB (or ATC) size                      32 entries        64 entries in each:
    44	                                                           Data, Code ATC
    45	Levels of protection                   4                 2
    46	Instruction pipeline stages            5                 6
    47	Pins                                   168               179
    48	-------------------------------------------------------------------------------
    49	
    50	 
    51	CPU General-Purpose Registers
    52	 
    53	        Both systems have 32-bit general-purpose registers; the 80486 has 8,
    54	while the 68040 has double that number, namely 16.   There are advantages
    55	(and disadvantages) to having a large register file.   The register file of
    56	the 80486 is definitely too small to avail itself to the advantages.   This
    57	is particularly exacerbated by the fact that the CPU registers of the 80486
    58	are not really quite as general purpose as one might wish.   In fact, all of
    59	them are dedicated to certain special tasks, such as:
    60	 
    61	EAX, EDX    Dedicated to multiplication/division operations
    62	EDX         Dedicated to some I/O operations
    63	EBX, EBP    Dedicated to serve as base registers for some addressing modes
    64	ECX         Dedicated to serve as a counter in LOOP instructions
    65	ESP         Dedicated to serve as a stack pointer
    66	ESI, EDI    Dedicated to serve as pointers in string instructions and as
    67	            index registers in some addressing modes
    68	
    69	On the other hand, on the MC68040 the eight 32-bit data registers D0 to D7
    70	are genuinely general purpose without any restrictions or specific tasks
    71	imposed on them.   Of the eight 32-bit address registers A0 to A7, only A7
    72	is dedicated as a stack pointer.   The user is free to use the other seven
    73	resgisters A0 to A6 in any possible way.
    74	 
    75	        From the point of view of the CPU register file, the MC68040 has a
    76	very clear advantage.   It is much better equipped to retain intermediate
    77	results during a program run, thus reducing CPU-memory traffic.   From this
    78	standpoint, the MC68040 even has a slight edge over the VAX architecture.
    79	The VAX (any VAX model) also has sixteen 32-bit general-purpose registers.
    80	However, only 12 of those (as opposed to the 68040's 15) can be used freely
    81	by the programmer.   Of the four VAX dedicated registers, one is used as a
    82	program counter and another as a stack pointer.   The program counter is
    83	completely separate on both the MC68040 and the 80486 and is not included in
    84	the general-purpose registers.
    85	 
    86	 
    87	FPU General-Purpose Registers
    88	 
    89	        Both systems have eight 80-bit registers, providing a large range for
    90	floating-point number representation and a high level of precision.   The only
    91	differnce between the two is that the 80486 FPU registers are organized as a
    92	stack, while those of the MC68040 are accessed directly, as its integer CPU
    93	registers.   Because of the stack organization the 80486 might have a slight
    94	edge from the standpoint of compiler generation (for that part of the compiler
    95	dealing with floating-point operations).
    96	 
    97	 
    98	MMU on Chip
    99	 
   100	        The 80486 has a regular MMU on chip for the control and management of
   101	its memory.   The MC68040 has two MMUs: one for code and one for data.   This
   102	duality, supported by a separate operand data bus, allows the control unit to
   103	handle instruction and operand fetching simultaneously in parallel and enhances
   104	the handling of the instruction pipeline.   Of course, the external bus leading
   105	to the off-chip main memory is single (32-bit data, 32-bit address), and it is
   106	shared by instructions and data operands.   With a reasonable on-chip cache hit
   107	ratio, the off-chip bus would be used less often.
   108	 
   109	 
   110	Cache on Chip
   111	 
   112	        The total on-chip cache of both systems is 8 kbytes.   Interestingly
   113	enough, they have the same parameters: both are four-way set-associative with
   114	16 bytes per line.   The difference is that while the 80486 on-chip 8k cache
   115	is mixed, storing both code and data the MC68040 cache is subdivided into two
   116	equal parts: a 4-kbyte data cache and a 4-kbyte code cache.   Each cache is
   117	controlled by the respective MMU, mentioned above.   The advantage, as in the
   118	MMU case, is the provision of two parallel paths for code and data, resulting
   119	in an overall speedup of operation.
   120	 
   121	 
   122	Segmentation
   123	 
   124	        The Intel 80x86 family implements segmentation, while the M68000 family
   125	does not.   The earlier Intel systems (8086, 80286) were plagued with the upper
   126	64-kbyte segment size limit, starting with the 80386 and so on, the segment sizecan be made as high as 4 Gbytes (maximum size of the physical memory),
   127	effectively removing the segmentation feature by the decision of the user.
   128	Therefore, as far as segmentation is concerned, the 80486 and MC68040 are
   129	comparable.   The 80486 has some edge, since it allows the user to implement
   130	segmentation if needed and avail oneself to its advantages.
   131	 
   132	 
   133	Paging
   134	 
   135	        The MMUs of both systems feature paged virtual memory management.
   136	The 80486 offers a single standard page size of 4 kbytes.   This page size
   137	is implemented in many other systems.   With a 4-kbyte page size, one can
   138	arrange an address mapping where the page directory and the page tables also
   139	have the standard page size of 4 kbytes (1024 = 2^10 entries, 4 bytes each).
   140	Thus, the page directory and the page tables can be treated as entire pages
   141	and placed within page frames in the memory.   This results in reduced
   142	complexity in the MMU hardware and in the OS software, one of whose tasks is
   143	to support the management of virtual memory.   The MC68040 offers two page
   144	sizes, selectable by the user: 4 kbytes and 8 kbytes.   This tends to
   145	complicate the MMU logic and the OS.   It is a good thing that Motorola got
   146	rid of the other page size options available with its MC68851 paged MMU:
   147	8 sizes ranging from 256 bytes to 32 kbytes, stepped by a factor of 2.   On the
   148	other hand, the 8-kbyte per page option could be useful to a programmer dealing
   149	with large modules of code exceeding 4 kbytes.
   150	 
   151	 
   152	TLB (or ATC) Size
   153	 
   154	        The 80486 MMU has a 32-entry TLB.   With a 4-kbyte page it covers
   155	32 x 4 kbytes = 128 kbytes of memory.   The MC68040 offers much more.   The TLB
   156	is called address translation cache (ATC) by Motorola, but it does the same:
   157	it translates virtual into physical addresses.   The name given by Motorola is
   158	simpler to perceive, although the TLB term is predominately used in the
   159	computer literature.   Each of the two MC68040 MMUs has a 64-entry ATC, for a
   160	total of 128 entries on the chip.   For a 4-kbyte page, a total of 128 x 4
   161	kbytes = 512 kbytes of memory is covered (4 times that of the 80486), and for
   162	an 8-kbyte page, 1 Mbyte (8 times that of 80486).   In this case, a strong
   163	advantage of the MC68040 is obvious.   Since the ATCs encompass much more
   164	memory, the ATC miss probability is considerably smaller.   Thus, less time
   165	will be wasted in accessing page tables in memory, resulting in faster overall
   166	operation.
   167	 
   168	 
   169	Levels of Protection
   170	 
   171	        The 80486 offers four levels of protection, while the MC68040 has only
   172	two - the supervisor and user, as does the whole M68000 family.   While the
   173	protection mechanism of the 80486 is much more sophisticated and, with the
   174	segmentation encapsulation of information, offers more reliable protection,
   175	it also results in more complicated on-chip logic.   More time is taken up with
   176	protection checks on the 80486.
   177	 
   178	 
   179	Instruction Pipeline Stages
   180	 
   181	        The 80486 instruction pipeline has five stages, while that of the
   182	MC68040 has six.   This means that the 80486 pipeline can handle five
   183	instructions simultaneously and the MC68040 can handle six.   This certainly
   184	gives an edge in favor of the MC68040, although its MMU-cache-internal buses
   185	duality is a much stronger contributor to its enhanced speed of operation.
   186	The above comments are valid if the instructions are executed sequentially,
   187	without any taken branches.   In the case of the taken branch, the subsequent
   188	prefetched instructions are flushed from the pipeline hardware.   Neither
   189	the 80486 nor the MC68040 employ the delayed branch feature, as do most of
   190	the RISC-type systems.   The MC68040 designers have investigated the possibilityof featuring a delayed branch or other techniques to alleviate the problem of
   191	lost cycles in case of a flushed pipeline.   After a number of simulations,
   192	they came to the conclusion that the gain in performance was not worth the
   193	extra hardware expenditure incurred in the implementation of any of the methods
   194	considered.   In RISC-type systems, on the other hand, due to reduced control
   195	circuitry there is extra space for features such as the delayed branch which
   196	alleviates the pipeline management problem in case of a taken branch.   Indeed,
   197	Intel's RISC 80860 and Motorola's RISC M88000 both implement the delayed branch
   198	technique as an option, selectable by the user.
   199	 
   200	 
   201	Performance Benchmarks
   202	
   203	
   204	Dhrystone Benchmark Version 2.1   (Integer Performance Test -- ALU)
   205	-----------------------------------------------------------------------------
   206	     System               Results - Kdhrystones/s            Relative
   207	-----------------------------------------------------------------------------
   208	VAX 11/780                        1.6                           1.0
   209	Motorola MC68030 (50 Mhz,1ws)    20.0                          12.5
   210	Intel 80486 (25 Mhz)             24.0                          15.0
   211	SPARC (25 Mhz)                   27.0                          16.8
   212	Motorola M88000 (20 Mhz)         33.3                          20.1
   213	MIPS M/2000, R3000 (25 Mhz)      39.4                          23.8
   214	Motorola MC68040 (25 Mhz)        40.0                          24.3
   215	Intel 80860 (33.3 Mhz)           67.3                          40.6
   216	-----------------------------------------------------------------------------
   217	
   218	
   219	        As one can see, the MC68040 Dhrystone integer performance considerably
   220	exceeds that of the 80486.   It should also be noted that the MC68040
   221	outperforms its predecessor MC68030 by a factor of 2, while the MC68030
   222	operates at a double frequency.
   223	
   224	
   225	Linpack Benchmark (Double-Precision, 100x100)   (F-P Performance Test -- FPU)
   226	-----------------------------------------------------------------------------
   227	     System               Results - MFLOPS
   228	-----------------------------------------------------------------------------
   229	VAX 11/780                        0.14
   230	NS32532 + NS32381                 0.17
   231	Intel 80386 + 80387 (20 Mhz)      0.20
   232	VAX 8600                          0.49
   233	Intel 80486 (25 Mhz)              1.0
   234	Motorola M88000 (20 Mhz)          1.2
   235	Sun SPARCstation 1                1.3
   236	Decstation 3100 (MIPS R2000)      1.6
   237	Sun 4/200 (SPARC)                 1.6
   238	Am29000 (25 Mhz)                  1.71
   239	IBM 3081                          2.1
   240	Motorola MC68040 (25 Mhz)         3.0
   241	R3000/R3010 (25 Mhz)              3.9
   242	Intel 80860                       4.5
   243	RS/6000 (25 Mhz)                 10.9
   244	Cray 1S                          12.0
   245	Cray X-MP                        56.0
   246	-----------------------------------------------------------------------------
   247	
   248	
   249	        Here, the MC68040 outperforms the 80486 by a factor of 3.   This
   250	performance ratio is well supported by the discussion given for the data
   251	in Table 1.1.
   252	
   253	        The fact that more RISC-type processors, tested above, outperform the
   254	80486 CISC should not escape notice either.   This is particularly significant
   255	for floating-point performance where the 80486 has an on-chip FPU, while the
   256	R3000 and the SPARC use off-chip coprocessors.
   257	
   258	        A comparison of memory access clock cycles needed for the execution of
   259	ADD instructions is reported in the following:
   260	
   261	
   262	Memory Access Clock Counts
   263	-----------------------------------------------------------------------------
   264	    Source        Destination         MC68040        80486        M88000
   265	-----------------------------------------------------------------------------
   266	ADD reg           reg                    1              1            1
   267	ADD mem           reg (cache hit)        1              2            3*
   268	ADD reg           mem (cache hit)        1              1            3*
   269	ADD mem           reg (cache miss)       3              4           15*
   270	-----------------------------------------------------------------------------
   271	 --"reg" represents a CPU register and "mem" represents a location in memory.
   272	  *Includes time to load register plus one clock for the ADD operation.
   273	 
   274	 
   275	        The superior performance of the MC68040 fits the discussion given
   276	earlier in this text.   It should also be noted that both the MC68040 and
   277	80486 have an on-chip cache, while the M88000 cache is on a separate CMMU
   278	chip (MC88200).
   279	 
   280	 
   281	        It should be noted that all of the above comparisons were conducted
   282	with artificial benchmark programs such as Dhrystone.   It is quite possible
   283	that for some "real-life" programs the performance ordering might be quite
   284	different.   It is no accident that when company A conducts benchmark
   285	experiments, its products come out ahead of others.   It is quite possible
   286	that when another company, say B, publishes its own benchmark results, the
   287	performance ordering may look different.   Therefore, the sample of benchmark
   288	comparison results presented should be regarded as a tentative indication.
   289	They are certainly not conclusive. 
   290	 <*><*><*><*><*><*><*><*><*><*><*><*><*><*><*><*><*><*><*><*><*><*><*><*><*>
   291	 <*>									 <*>
   292	 <*>   >>> THIS TEXTFILE PASSED THROUGH IMAGINE BBS ++46-42-135505 <<<   <*>
   293	 <*>       """""""""""""""""""""""""""""""""""""""""""""""""""""""       <*>
   294	 <*><*><*><*><*><*><*><*><*><*><*><*><*><*><*><*><*><*><*><*><*><*><*><*><*>
   295	          <úúSúCúOúOúPúEúXúúúSúWúEúDúEúNúúúHúEúAúDúQúUúAúRúTúEúRúú>
