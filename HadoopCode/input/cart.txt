     1	
     2	
     3	
     4	
     5	
     6	                                 _A_b_s_t_r_a_c_t
     7	
     8	
     9	     The Atari ST's 128 Kbyte read-only cartridge port can be
    10	     transformed into a 64 Kbyte read/write port by using this cir-
    11	     cuit. Writing to this port is slower than reading it by a factor
    12	     of two, approximately. It can be written to at a speed of
    13	     76 Kilowords per second.
    14	
    15	          This interface can be built by using only three chips, two
    16	     AS-TTLs and a PAL -- a total parts cost of less than $15.
    17	
    18	
    19	
    20	                               _H_o_w__I_t__w_o_r_k_s
    21	
    22	
    23	
    24	
    25	     1.  _B_a_c_k_g_r_o_u_n_d__I_n_f_o_r_m_a_t_i_o_n
    26	
    27	     The ST brings out 15 address lines (A1-A15),  16 data lines (d0-
    28	     D15) /LDS,[*] /UDS, /AS, /ROM4 and /ROM3.
    29	
    30	          Of these signals, /UDS, /LDS, and /AS have the same meaning
    31	     as they as they do for a 68000 CPU. A1-A15 are the least signifi-
    32	     cant 15 address lines. D0-D15 are connected internally to the
    33	     ST's data-bus. /ROM3 and /ROM4 are generated by the MMU and are
    34	     output signals which tell the external hardware which of the two
    35	     banks is being addressed. /ROM4 is activated when the 68000 tries
    36	     to read address 0xfa0000-0xfaffff. /ROM3 is activated when the
    37	     68000 tries to read address 0xfb0000-0xfbffff. (Note that the
    38	     names of these signals are counterintuitive; ie. they have been
    39	     correctly written above.)
    40	
    41	
    42	
    43	     2.  _C_a_v_e_a_t_s
    44	
    45	          Any and all hardware connected to this modified port must be
    46	     fast -- fast enough to run with no wait-states and fast enough to
    47	     tolerate the decoding delays introduced by this circuit. I've
    48	     used 200ns static RAM chips without any trouble.
    49	
    50	          It is advisable to use /ROM4 to time any external hardware
    51	     you build (in preference to /AS), since /ROM4 contains the neces-
    52	     sary delay to ensure the addresses are stable when it is
    53	     activated. (At least this is what I assumed, and it worked.)
    54	
    55	          The data for write operations is produced by the two AS-TTL
    56	     latches[*] used in the circuit (see below.)
    57	     ________
    58	     [*] A preceeding slash indicates an active-low signal
    59	
    60	
    61	
    62	     Cartridge Port Interface        1                  April 14, 1987
    63	
    64	
    65	
    66	
    67	
    68	
    69	
    70	
    71	
    72	     3.  _O_p_e_r_a_t_i_n_g__P_r_i_n_c_i_p_l_e
    73	
    74	      i.  The PAL contains an asynchronous finite state machine. When
    75	          the upper bank (address 0xfbxxxx) is read, the PAL manufac-
    76	          tures an A0 (based on the state of /UDS and /LDS) and sup-
    77	          plies this to U1. At the end of the read cycle, U1 and U2
    78	          are clocked to latch the least significant 16 address bits
    79	          into the PAL.
    80	
    81	     ii.  Subsequently, when the lower bank is read (address
    82	          0xfaxxxx), the latched address (which was latched in step 1)
    83	          is supplied as data and /PWE (the write-enable signal) is
    84	          activated (it goes low). /ROM4 active should tell the exter-
    85	          nal hardware that it is being addressed, and /PWE active
    86	          should tell it that this is a write-cycle.  As an interest-
    87	          ing  side-effect of this design, the data word written out
    88	          is read back by the 68000 (you can use this fact to debug
    89	          the interface!)
    90	
    91	     iii. Reads to the upper bank will return garbage unless some ROM
    92	          is present there. Multiple successive reads to this bank
    93	          will not be harmful (ie. they will not confuse the state-
    94	          machine) and the latest address will be latched preparation
    95	          for a read to the lower bank.
    96	
    97	               Note that if you put RAM in the upper-bank you will not
    98	          be able to write to it. Connecting the /PWE line to such RAM
    99	          will have no effect. Putting a ROM in this address space
   100	          should not create any problems (although I haven't tried
   101	          this).
   102	
   103	     Example:
   104	
   105	          To write data 0xcd01 to address 0x3bc0 in the lower bank,
   106	     the following steps are performed.
   107	
   108	
   109	             step1.  read byte at address 0xfbcd01   (0xfb0000+data)
   110	             step2.  read word to address 0xfa3bc0   (0xfa0000+addr)
   111	
   112	
   113	
   114	
   115	
   116	
   117	
   118	
   119	
   120	     _________________________________________________________________
   121	     [*] I used AS374s, you can use AS or FAST. High speed chips are
   122	         necessary so that delays from /OE (latch output-enable) to
   123	         valid data are not critical. You could possibly get away with
   124	         ALSTTL, but I haven't tried this.
   125	
   126	
   127	
   128	     Cartridge Port Interface        2                  April 14, 1987
   129	
   130	
   131	
   132	
   133	
   134	
   135	
   136	
   137	
   138	                               _C_o_n_s_t_r_u_c_t_i_o_n
   139	
   140	     The schematic should help in this department.  Constructing this
   141	     gadget is easy and cheap. The hardest part might be trying to
   142	     find a connector for this port. You can get one from
   143	
   144	          Douglas Electronics,
   145	          718 Marina Blvd.,
   146	          San Leandro, Calif
   147	          94577
   148	
   149	          1-415-483-8770
   150	
   151	          (part number 33-DE-40. $10.00 per piece)[*]
   152	
   153	     Another problem you might face is getting the PAL programmed.  If
   154	     you don't know of a way to get the PAL programmed, you could use
   155	     discrete logic chips to build the state machine.
   156	
   157	
   158	
   159	     4.  _B_u_i_l_d_i_n_g__i_t
   160	
   161	          The pin-outs given in the User's guide are CORRECT. The
   162	     pin-outs given in the "Internals" book are WRONG.  Follow the
   163	     schematic. You can get the pin-outs for the '374s from an ASTTL
   164	     or FAST databook. The PAL16L8's pin-outs are given below.
   165	
   166	
   167	
   168	
   169	
   170	
   171	
   172	
   173	
   174	
   175	
   176	
   177	
   178	
   179	
   180	
   181	
   182	
   183	
   184	
   185	
   186	
   187	
   188	     ________
   189	     [*] You guessed it -- I'm not connected with D.E. although I and
   190	         a number of others have purchased these connectors from them.
   191	
   192	
   193	
   194	     Cartridge Port Interface        3                  April 14, 1987
   195	
   196	
   197	
   198	
   199	
   200	
   201	
   202	
   203	
   204	                             PAL PINOUTS
   205	
   206	     Legend:
   207	
   208	     A preceding slash implies an active-low signal.
   209	     NC implies no-contact (nothing should be connected to these pins.)
   210	     (i) indicates that the signal is an input.
   211	     (o) indicates that the signal is an output.
   212	     (A) implies that the signal comes from/goes to the Atari cart. port.
   213	     (u1) implies that the signal goes to U1, the least-significant
   214	             latch.
   215	     (u2) implies that the signal goes to U2, the most-significant
   216	             latch.
   217	     (ex) implies that the signal goes to any external hardware connected
   218	             such as a ram-disk.
   219	
   220	     pin #           signal                  pin #           signal
   221	     -----           ------                  -----           ------
   222	
   223	     1               /UDS (i, A)             11              NC (no contact)
   224	     2               /LDS (i, A)             12              /OE (o, U1, U2)
   225	     3               /ROM4 (i, A)            13              A0 (o, U1)
   226	     4               /ROM3 (i, A)            14              /PWE (o, ex)
   227	     5               NC                      15              NC
   228	     6               NC                      16              /dclk (o, U1,U2)
   229	     7               NC                      17              NC
   230	     8               NC                      18              NC
   231	     9               NC                      19              NC
   232	     10              gnd (A)                 20              Vcc (A)
   233	
   234	
   235	             Note that the line called "help" is shown as
   236	             "NC" since it is to be left unconnected.
   237	
   238	
   239	                             ALL THE BEST!!
   240	
   241	
   242	             Anees Munshi. April 14, 1986.
   243	
   244	             ARPA        asm%csri.toronto.edu@csnet-relay.arpa
   245	             BitNet      asm@utcsri.UTORONTO
   246	             CSNet       asm@csri.toronto.edu
   247	             UUCP        {allegra,ihnp4,decvax,pyramid}!utzoo!utcsri!asm
   248	
   249	
   250	             58 York Road, Weston, Ontario M9R 3E6. Canada. (416) 241-2166
   251	
   252	
   253	
   254	
   255	
   256	
   257	
   258	
   259	
   260	     Cartridge Port Interface        4                  April 14, 1987
   261	
   262	
   263	
   264	
   265	